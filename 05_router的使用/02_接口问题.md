

#接口的调试  /utills/api  /utills/axios

解决 购物车中添加商品，查询商品，删除商品，修改商品，登录验证的问题

工具包: axios包 基于ajax和promise 封装的http库

1.结论: 所有的函数是对象,但 所有的对象 不一定 是函数,
        通过console.log(fn)可以看到函数代码体
        通过 console.dir(fn)可以看到函数对象上的属性和方法


# axios 在 vue 中的使用
1. 引入 import axios from 'axios'
2. 创建实例
```javascript
ax = axios.create({
        baseUrl:'http://localhost:8080',
        timeout:7000,
        headers:[]
})

注意点：ax 是一个函数，也是对象，所以可以直接调用它
3.调用ax 
  ax({
          url:'/api/v1/user/login',
          method:'post'
          data:{name:'lsy',age:'25'}  //data 是前端传递的参数
  })
```
3. 设置请求拦截器
```javascript
instance.interceptors.request.use(function (config) {

 <!-- 在请求发送之前可以干一些事情，比如携带token -->

  config.headers.Authorization = localStorage.getItem('token')
<!-- 参数config 中记录了相关的配置信息 -->
<!-- {url: "/api/v1/user/login", method: "post", data: {…}, headers: {…}, baseURL: "http://localhost:8080", …} -->
 <!-- 必须要有 return config -->
  return config;

   }, function (error) {

   return Promise.reject(error);

});
```
#问题：若不设置请求拦截器,可以发送出去吗？

4. 设置响应拦截器
```javascript
instance.interceptors.response.use(function (response) {
  // 当后端返回数据，抵达客户端时
  // 要数据过滤
  // 对后端响应信息进行处理

// <!-- response 对象中包含相关的信息，在data中可以找到后端返回的数据 -->
// <!-- 可查看data 进行下一步处理，例如找出关键性数据，return出去，给到前端渲染,也可以提示密码错误，重返登录页，也可在登录组件中设置提示，重定向-->

  // {
  //       data: {err: 0, msg: "success", data: {…}}
  //       status: 200
  //       statusText: "OK"
  // }
  
  var res = response.data.data

  return res;  //将关键性数据返回给前端

}, function (error) {
  return Promise.reject(error);
});
```
# 接口api路由的配置

1. axios 的GET 请求 用 params 选项向后端传递数据
2. axios POST 请求 用 data 选项向后端传递数据

```javascript
// 1.调用ax函数

ax({
  url:'/api/v1/good/addOrEdit',
  method:'post'
  params:{name:'lsy'}
})

```


5. 综上所述，完整的流程

前端发送数据--调用ax 函数，实参为对象,对象中可配置url,data()
